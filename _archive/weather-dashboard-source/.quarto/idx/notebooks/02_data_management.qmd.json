{"title":"WeatherVista Project - Session 2: Data Management with CSV and SQL","markdown":{"yaml":{"title":"WeatherVista Project - Session 2: Data Management with CSV and SQL","execute":{"enabled":false}},"headingText":"Objectives","containsRefs":false,"markdown":"\n\n- Learn how to manage weather data using CSV files.\n- Understand how to use SQL to store and retrieve weather data.\n- Practice reading, writing, and processing data with pandas and SQLite.\n\n## 1. Managing Data with CSV Files\nCSV (Comma-Separated Values) is a simple and widely used format for storing tabular data.\n\n### Import Required Libraries\n```{python}\nimport pandas as pd\n```\n\n\n### Reading Data from a CSV File\nWe will read the weather data we saved in the previous session.\n\n```{python}\ndf = pd.read_csv('data/raw/weather_data.csv')\ndf\n```\n\n### Processing Data\nLet's process the data by converting the temperature from Kelvin to Celsius.\n\n```{python}\ndef convert_temp_kelvin_to_celsius(temp_k):\n    return temp_k - 273.15\n\ndf['Temperature (C)'] = df['Temperature (K)'].apply(convert_temp_kelvin_to_celsius)\ndf.drop(columns=['Temperature (K)'], inplace=True)\ndf\n```\n\n### Writing Data to a CSV File\nWe'll save the processed data to a new CSV file.\n\n```{python}\ndf.to_csv('data/processed/processed_weather_data.csv', index=False)\n```\n\n## 2. Managing Data with SQL\nSQL (Structured Query Language) is a powerful tool for managing and querying data stored in relational databases.\n\n### Import Required Libraries\n```{python}\nimport sqlite3\n```\n\n### Creating a SQLite Database and Table\nWe'll create a SQLite database and a table to store the weather data.\n\n```{python}\nconn = sqlite3.connect('data/weather_data.db')\ncursor = conn.cursor()\n\ncursor.execute('''\n    CREATE TABLE IF NOT EXISTS weather (\n        location TEXT,\n        temperature_c REAL,\n        humidity INTEGER,\n        weather_description TEXT\n    )\n''')\nconn.commit()\n```\n\n### Inserting Data into the Table\nWe'll insert the processed weather data into the SQLite table.\n\n```{python}\nfor index, row in df.iterrows():\n    cursor.execute('''\n        INSERT INTO weather (location, temperature_c, humidity, weather_description)\n        VALUES (?, ?, ?, ?)\n    ''', (row['Location'], row['Temperature (C)'], row['Humidity (%)'], row['Weather']))\nconn.commit()\n```\n\n### Querying Data from the Table\nWe'll query the data we just inserted into the SQLite table.\n\n```{python}\ncursor.execute('SELECT * FROM weather')\nrows = cursor.fetchall()\nfor row in rows:\n    print(row)\n```\n\n### Converting SQL Query Results to DataFrame\nWe'll convert the query results to a pandas DataFrame for easier manipulation and visualization.\n\n```{python}\ndf_sql = pd.DataFrame(rows, columns=['Location', 'Temperature (C)', 'Humidity (%)', 'Weather'])\ndf_sql\n```\n\n## 3. Combining CSV and SQL Data Management\nWe'll demonstrate how to combine CSV and SQL data management techniques.\n\n### Reading Data from CSV and Inserting into SQL\nWe'll read additional weather data from a CSV file and insert it into the SQLite table.\n\n```{python}\nadditional_data = pd.read_csv('data/raw/additional_weather_data.csv')\nfor index, row in additional_data.iterrows():\n    cursor.execute('''\n        INSERT INTO weather (location, temperature_c, humidity, weather_description)\n        VALUES (?, ?, ?, ?)\n    ''', (row['Location'], row['Temperature (C)'], row['Humidity (%)'], row['Weather']))\nconn.commit()\n```\n\n### Querying Combined Data\nWe'll query the combined data from the SQLite table.\n\n```{python}\ncursor.execute('SELECT * FROM weather')\ncombined_rows = cursor.fetchall()\ndf_combined = pd.DataFrame(combined_rows, columns=['Location', 'Temperature (C)', 'Humidity (%)', 'Weather'])\ndf_combined\n```\n\n## Homework\n- Practice reading and writing data to CSV files with different weather datasets.\n- Explore additional SQL queries to retrieve specific subsets of the weather data.\n\n## Summary\nIn this session, we learned how to manage weather data using CSV files and SQL. We practiced reading, writing, and processing data with pandas and SQLite, and we combined both techniques to manage our weather data effectively.\n\nNext session, we will focus on basic data visualization with Matplotlib.\n","srcMarkdownNoYaml":"\n\n## Objectives\n- Learn how to manage weather data using CSV files.\n- Understand how to use SQL to store and retrieve weather data.\n- Practice reading, writing, and processing data with pandas and SQLite.\n\n## 1. Managing Data with CSV Files\nCSV (Comma-Separated Values) is a simple and widely used format for storing tabular data.\n\n### Import Required Libraries\n```{python}\nimport pandas as pd\n```\n\n\n### Reading Data from a CSV File\nWe will read the weather data we saved in the previous session.\n\n```{python}\ndf = pd.read_csv('data/raw/weather_data.csv')\ndf\n```\n\n### Processing Data\nLet's process the data by converting the temperature from Kelvin to Celsius.\n\n```{python}\ndef convert_temp_kelvin_to_celsius(temp_k):\n    return temp_k - 273.15\n\ndf['Temperature (C)'] = df['Temperature (K)'].apply(convert_temp_kelvin_to_celsius)\ndf.drop(columns=['Temperature (K)'], inplace=True)\ndf\n```\n\n### Writing Data to a CSV File\nWe'll save the processed data to a new CSV file.\n\n```{python}\ndf.to_csv('data/processed/processed_weather_data.csv', index=False)\n```\n\n## 2. Managing Data with SQL\nSQL (Structured Query Language) is a powerful tool for managing and querying data stored in relational databases.\n\n### Import Required Libraries\n```{python}\nimport sqlite3\n```\n\n### Creating a SQLite Database and Table\nWe'll create a SQLite database and a table to store the weather data.\n\n```{python}\nconn = sqlite3.connect('data/weather_data.db')\ncursor = conn.cursor()\n\ncursor.execute('''\n    CREATE TABLE IF NOT EXISTS weather (\n        location TEXT,\n        temperature_c REAL,\n        humidity INTEGER,\n        weather_description TEXT\n    )\n''')\nconn.commit()\n```\n\n### Inserting Data into the Table\nWe'll insert the processed weather data into the SQLite table.\n\n```{python}\nfor index, row in df.iterrows():\n    cursor.execute('''\n        INSERT INTO weather (location, temperature_c, humidity, weather_description)\n        VALUES (?, ?, ?, ?)\n    ''', (row['Location'], row['Temperature (C)'], row['Humidity (%)'], row['Weather']))\nconn.commit()\n```\n\n### Querying Data from the Table\nWe'll query the data we just inserted into the SQLite table.\n\n```{python}\ncursor.execute('SELECT * FROM weather')\nrows = cursor.fetchall()\nfor row in rows:\n    print(row)\n```\n\n### Converting SQL Query Results to DataFrame\nWe'll convert the query results to a pandas DataFrame for easier manipulation and visualization.\n\n```{python}\ndf_sql = pd.DataFrame(rows, columns=['Location', 'Temperature (C)', 'Humidity (%)', 'Weather'])\ndf_sql\n```\n\n## 3. Combining CSV and SQL Data Management\nWe'll demonstrate how to combine CSV and SQL data management techniques.\n\n### Reading Data from CSV and Inserting into SQL\nWe'll read additional weather data from a CSV file and insert it into the SQLite table.\n\n```{python}\nadditional_data = pd.read_csv('data/raw/additional_weather_data.csv')\nfor index, row in additional_data.iterrows():\n    cursor.execute('''\n        INSERT INTO weather (location, temperature_c, humidity, weather_description)\n        VALUES (?, ?, ?, ?)\n    ''', (row['Location'], row['Temperature (C)'], row['Humidity (%)'], row['Weather']))\nconn.commit()\n```\n\n### Querying Combined Data\nWe'll query the combined data from the SQLite table.\n\n```{python}\ncursor.execute('SELECT * FROM weather')\ncombined_rows = cursor.fetchall()\ndf_combined = pd.DataFrame(combined_rows, columns=['Location', 'Temperature (C)', 'Humidity (%)', 'Weather'])\ndf_combined\n```\n\n## Homework\n- Practice reading and writing data to CSV files with different weather datasets.\n- Explore additional SQL queries to retrieve specific subsets of the weather data.\n\n## Summary\nIn this session, we learned how to manage weather data using CSV files and SQL. We practiced reading, writing, and processing data with pandas and SQLite, and we combined both techniques to manage our weather data effectively.\n\nNext session, we will focus on basic data visualization with Matplotlib.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"0":"*.qmd","1":"!*.ipynb","keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"02_data_management.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.551","theme":"cosmo","title":"WeatherVista Project - Session 2: Data Management with CSV and SQL"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}