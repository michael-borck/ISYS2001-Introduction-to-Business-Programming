---
title: "Week 8 Solutions: Business Data Processing with AI Collaboration"
subtitle: "ISYS2001 Introduction to Business Programming - Instructor Solutions"
author: "Course Staff"
date: "September 2024"
format: 
  html:
    toc: true
    toc-expand: 2
    code-fold: true
    code-summary: "Show Solution Code"
    embed-resources: true
---

# ðŸ“š Instructor Solutions and Assessment Guide

This document provides complete solutions for Week 8 activities and exit ticket assessment criteria.

**Key Assessment Focus**: Students should demonstrate AI collaboration skills and basic business data processing, not perfect pandas mastery.

---

# ðŸŽ¯ Exit Ticket Requirements and Rubric

## Core Requirements Checklist

Students must complete the following to pass Week 8 exit ticket:

### âœ… Technical Implementation (60%)
- [ ] **Repository Setup**: Successfully forked assignment template
- [ ] **Data Loading**: CSV file loads without errors, basic data validation
- [ ] **Analysis Function**: At least one working spending summary function
- [ ] **Business Output**: Results formatted for business presentation
- [ ] **Git Commit**: Meaningful commit message with progress description

### âœ… AI Collaboration Evidence (25%)
- [ ] **Documented Interactions**: At least 3 AI collaborations recorded in diary
- [ ] **Prompt Quality**: Evidence of effective AI prompting techniques
- [ ] **Critique Process**: Shows improvement/refinement of AI responses
- [ ] **Learning Reflection**: Meaningful insights about AI collaboration

### âœ… Professional Standards (15%)
- [ ] **Code Comments**: Clear explanations of business logic
- [ ] **Error Handling**: Basic validation for data issues
- [ ] **Business Context**: Analysis connects to real-world finance scenarios

## Assessment Rubric

| Criterion | Excellent (A) | Good (B) | Satisfactory (C) | Needs Work (F) |
|-----------|---------------|----------|------------------|----------------|
| **Technical Implementation** | All functions work flawlessly, handles edge cases, professional code quality | Most functions work, minor issues, good code structure | Basic functionality working, some issues but progress clear | Major technical problems, minimal working code |
| **AI Collaboration** | Sophisticated prompts, clear critique process, excellent documentation | Good AI usage, adequate documentation, some critique evident | Basic AI interaction documented, minimal refinement shown | Poor AI collaboration evidence, inadequate documentation |
| **Business Application** | Clear business insights, professional formatting, actionable recommendations | Good business context, adequate formatting, relevant analysis | Basic business connection, simple formatting, limited insights | Minimal business relevance, poor presentation |

---

# ðŸ“Š Sample Solutions

## Solution 1: Data Loading and Exploration

### Effective AI Prompt Example
```
"I'm building a Smart Finance Assistant for my programming assignment. I have a CSV 
file with transaction data (Date, Amount, Category, Description). The Amount column 
has dollar signs that need cleaning. Please write professional Python code that:
1. Loads the CSV data safely
2. Cleans the Amount column and converts to numeric
3. Handles missing values and data errors  
4. Shows basic information about the dataset
5. Includes clear comments for each step"
```

### Solution Code

```{python}
import pandas as pd
import numpy as np
from datetime import datetime

def load_and_clean_transactions(file_path):
    """
    Load and clean transaction data for the Smart Finance Assistant
    
    Args:
        file_path (str): Path to the CSV file
        
    Returns:
        pd.DataFrame: Cleaned transaction data
    """
    try:
        # Load the CSV file
        print("ðŸ“ Loading transaction data...")
        df = pd.read_csv(file_path)
        print(f"âœ… Loaded {len(df)} transactions")
        
        # Display basic info about the raw data
        print(f"\nðŸ“‹ Data Structure:")
        print(f"Columns: {list(df.columns)}")
        print(f"Date range: {df['Date'].min()} to {df['Date'].max()}")
        
        # Clean the Amount column - remove dollar signs and convert to numeric
        print("\nðŸ’° Cleaning amount data...")
        df['Amount_Clean'] = pd.to_numeric(
            df['Amount'].str.replace('$', '').str.replace(',', ''), 
            errors='coerce'
        )
        
        # Check for data quality issues
        missing_amounts = df['Amount_Clean'].isna().sum()
        if missing_amounts > 0:
            print(f"âš ï¸  Found {missing_amounts} invalid amounts - removing these rows")
            df = df.dropna(subset=['Amount_Clean'])
        
        # Convert dates to datetime format
        df['Date'] = pd.to_datetime(df['Date'], errors='coerce')
        
        # Remove rows with invalid dates
        date_issues = df['Date'].isna().sum()
        if date_issues > 0:
            print(f"âš ï¸  Found {date_issues} invalid dates - removing these rows")
            df = df.dropna(subset=['Date'])
        
        # Final data summary
        print(f"\nâœ¨ Clean dataset ready:")
        print(f"Final rows: {len(df)}")
        print(f"Categories: {df['Category'].nunique()}")
        print(f"Amount range: ${df['Amount_Clean'].min():.2f} to ${df['Amount_Clean'].max():.2f}")
        
        return df
        
    except FileNotFoundError:
        print(f"âŒ Error: Could not find file {file_path}")
        return None
    except Exception as e:
        print(f"âŒ Error loading data: {e}")
        return None

# Load the data
transactions_df = load_and_clean_transactions('../data/transactions.csv')
if transactions_df is not None:
    print("\nðŸ“Š Sample of cleaned data:")
    print(transactions_df[['Date', 'Amount_Clean', 'Category', 'Description']].head())
```

## Solution 2: Spending Analysis Function

### AI Collaboration Example
**Student Prompt**: *"Create a function that analyzes spending by category and provides business insights suitable for a financial planning meeting"*

**Improved Prompt After Critique**: *"Create a comprehensive spending analysis function that calculates total and average spending by category, identifies the top spending areas, and formats results professionally for a business presentation. Include percentage breakdowns and actionable insights."*

### Solution Code

```{python}
def analyze_spending_patterns(df):
    """
    Comprehensive spending analysis for the Smart Finance Assistant
    
    Args:
        df (pd.DataFrame): Cleaned transaction data with Amount_Clean column
        
    Returns:
        dict: Dictionary containing analysis results and insights
    """
    
    # Calculate spending metrics by category
    spending_summary = df.groupby('Category')['Amount_Clean'].agg({
        'Total_Spent': 'sum',
        'Average_Amount': 'mean',
        'Transaction_Count': 'count',
        'Max_Single_Purchase': 'max'
    }).round(2)
    
    # Calculate percentages
    total_spending = spending_summary['Total_Spent'].sum()
    spending_summary['Percentage'] = (
        spending_summary['Total_Spent'] / total_spending * 100
    ).round(1)
    
    # Sort by total spending (descending)
    spending_summary = spending_summary.sort_values('Total_Spent', ascending=False)
    
    # Generate business insights
    top_category = spending_summary.index[0]
    top_amount = spending_summary.loc[top_category, 'Total_Spent']
    top_percentage = spending_summary.loc[top_category, 'Percentage']
    
    # Find categories that might need attention
    high_frequency_low_value = spending_summary[
        (spending_summary['Transaction_Count'] > spending_summary['Transaction_Count'].median()) &
        (spending_summary['Average_Amount'] < spending_summary['Average_Amount'].median())
    ]
    
    # Package results
    results = {
        'summary_table': spending_summary,
        'total_spending': total_spending,
        'top_category': top_category,
        'top_amount': top_amount,
        'top_percentage': top_percentage,
        'high_frequency_categories': list(high_frequency_low_value.index),
        'category_count': len(spending_summary)
    }
    
    return results

# Generate analysis
if transactions_df is not None:
    analysis_results = analyze_spending_patterns(transactions_df)
    
    # Display professional business report
    print("ðŸ’¼ SMART FINANCE ASSISTANT - SPENDING ANALYSIS REPORT")
    print("=" * 65)
    print(f"Report Generated: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print(f"Analysis Period: {transactions_df['Date'].min().strftime('%Y-%m-%d')} to {transactions_df['Date'].max().strftime('%Y-%m-%d')}")
    print(f"Total Transactions Analyzed: {len(transactions_df)}")
    print("\n")
    
    # Summary table
    print("ðŸ“Š SPENDING BREAKDOWN BY CATEGORY")
    print("-" * 65)
    summary = analysis_results['summary_table']
    print(f"{'Category':<15} {'Total':<10} {'Avg':<8} {'Count':<6} {'%':<6}")
    print("-" * 65)
    
    for category, row in summary.iterrows():
        total = row['Total_Spent']
        avg = row['Average_Amount']
        count = int(row['Transaction_Count'])
        pct = row['Percentage']
        print(f"{category:<15} ${total:<9.2f} ${avg:<7.2f} {count:<6} {pct:<6.1f}%")
    
    print("-" * 65)
    print(f"{'TOTAL':<15} ${analysis_results['total_spending']:<9.2f}")
    
    # Key insights
    print("\nðŸ’¡ KEY FINANCIAL INSIGHTS")
    print("-" * 30)
    print(f"â€¢ Highest spending category: {analysis_results['top_category']}")
    print(f"  Amount: ${analysis_results['top_amount']:.2f} ({analysis_results['top_percentage']:.1f}% of total)")
    
    if analysis_results['high_frequency_categories']:
        print(f"â€¢ Categories with frequent small purchases: {', '.join(analysis_results['high_frequency_categories'])}")
        print("  ðŸ’° Tip: These might offer savings opportunities!")
    
    print(f"â€¢ You shop across {analysis_results['category_count']} different spending categories")
    print(f"â€¢ Average transaction: ${analysis_results['total_spending'] / len(transactions_df):.2f}")
```

## Solution 3: Business Insights Generator

```{python}
def generate_financial_recommendations(analysis_results, df):
    """
    Generate actionable financial recommendations based on spending analysis
    
    Args:
        analysis_results (dict): Results from analyze_spending_patterns
        df (pd.DataFrame): Original transaction data
        
    Returns:
        str: Formatted recommendations report
    """
    
    summary = analysis_results['summary_table']
    
    recommendations = []
    
    # Analyze high-spending categories
    if analysis_results['top_percentage'] > 40:
        recommendations.append(
            f"ðŸ”´ HIGH PRIORITY: {analysis_results['top_category']} represents "
            f"{analysis_results['top_percentage']:.1f}% of your spending. "
            f"Consider if this aligns with your financial priorities."
        )
    
    # Find categories with high transaction frequency
    frequent_categories = summary[summary['Transaction_Count'] > 5]
    if len(frequent_categories) > 0:
        top_frequent = frequent_categories.index[0]
        recommendations.append(
            f"ðŸŸ¡ FREQUENT SPENDING: You make frequent {top_frequent.lower()} purchases. "
            f"Consider bulk buying or subscription services for potential savings."
        )
    
    # Check for small frequent purchases
    small_frequent = summary[
        (summary['Average_Amount'] < 20) & 
        (summary['Transaction_Count'] > 3)
    ]
    if len(small_frequent) > 0:
        categories = ', '.join(small_frequent.index[:2])  # Top 2
        recommendations.append(
            f"ðŸ’¡ OPTIMIZATION OPPORTUNITY: Small frequent purchases in {categories} "
            f"add up over time. Track these carefully."
        )
    
    # Look for unusual patterns
    high_variation = summary[summary['Max_Single_Purchase'] > summary['Average_Amount'] * 3]
    if len(high_variation) > 0:
        recommendations.append(
            f"ðŸ“ˆ SPENDING VARIATION: Some categories show high variation in purchase amounts. "
            f"This might indicate impulse purchases or seasonal spending."
        )
    
    # Positive reinforcement
    if analysis_results['category_count'] <= 6:
        recommendations.append(
            f"âœ… GOOD DISCIPLINE: You maintain focused spending across "
            f"{analysis_results['category_count']} main categories."
        )
    
    # Format the recommendations
    if recommendations:
        report = "\nðŸŽ¯ PERSONALIZED FINANCIAL RECOMMENDATIONS\n"
        report += "=" * 45 + "\n"
        for i, rec in enumerate(recommendations, 1):
            report += f"\n{i}. {rec}\n"
        
        report += "\nðŸ“ˆ NEXT STEPS:\n"
        report += "â€¢ Set spending limits for your top categories\n"
        report += "â€¢ Track progress weekly using this analysis\n"
        report += "â€¢ Consider automating savings from identified opportunities\n"
        
        return report
    else:
        return "\nâœ… Your spending patterns look well-balanced!"

# Generate recommendations
if transactions_df is not None and 'analysis_results' in locals():
    recommendations = generate_financial_recommendations(analysis_results, transactions_df)
    print(recommendations)
```

---

# ðŸ§ª Testing Solutions and Edge Cases

## Test Cases Students Should Consider

```{python}
def test_financial_functions():
    """
    Basic test cases for the financial analysis functions
    Students should create similar tests for their assignment
    """
    
    print("ðŸ§ª TESTING FINANCIAL ANALYSIS FUNCTIONS")
    print("=" * 45)
    
    # Test 1: Create sample data with known results
    test_data = pd.DataFrame({
        'Date': ['2024-08-01', '2024-08-02', '2024-08-03'],
        'Amount': ['$100.00', '$50.00', '$25.00'],
        'Category': ['Groceries', 'Groceries', 'Coffee'],
        'Description': ['Test 1', 'Test 2', 'Test 3']
    })
    
    print("Test 1: Basic functionality with clean data")
    cleaned_test = load_and_clean_transactions('test_data.csv')  # Would need to create file
    
    # Test 2: Edge cases
    print("\nTest 2: Edge cases")
    edge_cases = pd.DataFrame({
        'Date': ['2024-08-01', '2024-08-02', '2024-08-03', '2024-08-04'],
        'Amount': ['$-50.00', '$0.00', 'invalid', '$1000000.00'],  # Refund, zero, invalid, large
        'Category': ['Refund', 'Free', 'Error', 'Investment'],
        'Description': ['Refund test', 'Free sample', 'Bad data', 'Large purchase']
    })
    
    # Students should verify:
    # - Negative amounts handled correctly
    # - Invalid data filtered out
    # - Large amounts don't break calculations
    # - Zero amounts processed appropriately
    
    print("âœ… Test framework ready - students should expand these tests")

# Run basic test demonstration
if transactions_df is not None:
    test_financial_functions()
```

---

# ðŸ“ Common Student Mistakes and Solutions

## Mistake 1: Poor AI Prompting

**Student Mistake**: *"Help me with pandas"*

**Improvement**: *"I have CSV transaction data with Date, Amount (with $ signs), Category, Description columns. I need to calculate total spending by category and show results sorted from highest to lowest. Please write pandas code with comments explaining each step for my Smart Finance Assistant project."*

**Teaching Point**: Specific context + clear requirements = better AI responses

## Mistake 2: Not Critiquing AI Code

**Student Accepts This**:
```python
df.groupby('cat')['amt'].sum()
```

**Should Request This**:
```python
# Group transactions by category and calculate total spending
category_totals = transactions_df.groupby('Category')['Amount_Clean'].sum()
category_totals = category_totals.sort_values(ascending=False)
```

**Teaching Point**: Always ask AI to make code more readable and business-appropriate

## Mistake 3: Ignoring Data Quality

**Student Code**:
```python
total = df['Amount'].sum()  # This will fail with $ signs
```

**Better Approach**:
```python
# Clean and validate amount data before calculations
df['Amount_Clean'] = pd.to_numeric(df['Amount'].str.replace('$', ''), errors='coerce')
df_clean = df.dropna(subset=['Amount_Clean'])
total = df_clean['Amount_Clean'].sum()
```

## Mistake 4: No Business Context

**Technical Output**:
```python
print(spending_by_category)
```

**Business-Appropriate Output**:
```python
print("ðŸ’° Monthly Spending Summary")
print("=" * 30)
for category, amount in spending_by_category.items():
    percentage = (amount / spending_by_category.sum()) * 100
    print(f"{category}: ${amount:.2f} ({percentage:.1f}%)")
```

---

# ðŸŽ¯ Exit Ticket Assessment Guide

## Rapid Assessment Checklist

**Walk around the classroom and verify each student has:**

### Minimum Viable Implementation âœ…
- [ ] Repository forked successfully
- [ ] CSV loads without Python errors
- [ ] At least one analysis function produces output
- [ ] Basic business formatting ($ signs, readable labels)
- [ ] Git commit made with meaningful message

### AI Collaboration Evidence âœ…
- [ ] Developer's Diary has at least 3 entries
- [ ] Shows original AI prompt and response
- [ ] Evidence of improving/critiquing AI output
- [ ] Reflection on what they learned

### Professional Standards âœ…
- [ ] Code has explanatory comments
- [ ] Variable names are business-appropriate
- [ ] Results formatted for business presentation
- [ ] No hardcoded values that limit flexibility

## Quick Troubleshooting

**Student hasn't made progress after 45 minutes:**
1. Help them get ONE function working
2. Focus on exit ticket requirements only
3. Pair with successful student
4. Document need for follow-up support

**Student's code doesn't work:**
1. Check data loading first (most common issue)
2. Guide them to ask AI for debugging help
3. Show them how to simplify the problem
4. Focus on partial credit rather than perfection

**Student hasn't documented AI interactions:**
1. Have them recreate one interaction live
2. Show diary template structure
3. Emphasize this is 25% of exit ticket grade
4. Give them 5 minutes to document what they remember

---

# ðŸ“Š Grade Recording Template

```
Week 8 Exit Ticket Assessment
Student: [Name]
Date: [Date]

TECHNICAL IMPLEMENTATION (60% of exit ticket):
â–¡ Repository Setup (Pass/Fail): ___
â–¡ Data Loading Works (Pass/Fail): ___  
â–¡ Analysis Function Works (Pass/Fail): ___
â–¡ Business Formatting (Pass/Fail): ___
â–¡ Git Commit Made (Pass/Fail): ___
Technical Score: ___/5

AI COLLABORATION (25% of exit ticket):
â–¡ 3+ Diary Entries (Pass/Fail): ___
â–¡ Good Prompts Shown (Pass/Fail): ___
â–¡ Critique Process (Pass/Fail): ___
AI Score: ___/3

PROFESSIONAL STANDARDS (15% of exit ticket):
â–¡ Code Comments (Pass/Fail): ___
â–¡ Business Context (Pass/Fail): ___
Professional Score: ___/2

OVERALL EXIT TICKET: Pass/Fail
NOTES: [Any specific observations or follow-up needed]
```

---

# ðŸš€ Week 9 Preparation Notes

Students completing Week 8 successfully should have:
- Working CSV processing foundation
- Established AI collaboration workflow
- Active assignment repository
- Documented learning process

**Week 9 should build on this by adding:**
- Data visualization capabilities
- Enhanced business insights
- More sophisticated AI interactions
- Continued assignment development

**Students who struggle with Week 8 should:**
- Receive individual support before Week 9
- Focus on catching up with basic requirements
- Be paired with successful peers
- Consider whether they need 6 out of 8 tickets strategy

**Key Success Metric**: Students should leave feeling excited about their assignment progress and confident in their AI collaboration abilities, not overwhelmed or behind.